//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
// Zen BatBall
//
// Copyright (C) 2001 - 2008 Tony Richards
//
//  This software is provided 'as-is', without any express or implied
//  warranty.  In no event will the authors be held liable for any damages
//  arising from the use of this software.
//
//  Permission is granted to anyone to use this software for any purpose,
//  including commercial applications, and to alter it and redistribute it
//  freely, subject to the following restrictions:
//
//  1. The origin of this software must not be misrepresented; you must not
//     claim that you wrote the original software. If you use this software
//     in a product, an acknowledgment in the product documentation would be
//     appreciated but is not required.
//  2. Altered source versions must be plainly marked as such, and must not be
//     misrepresented as being the original software.
//  3. This notice may not be removed or altered from any source distribution.
//
//  Tony Richards trichards@indiezen.com
//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
#include "BaseObject.hpp"

#include "PongGameClient.hpp"

#include <Zen/Engine/Resource/I_ResourceManager.hpp>
#include <Zen/Engine/Resource/I_ResourceService.hpp>

#include <Zen/Starter/Base/BaseClient/I_BaseGameClient.hpp>

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
namespace Zen {
namespace Pong {
//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
BaseObject::BaseObject(Zen::Engine::Core::I_GameGroup& _group, const std::string& _name)
:   m_name(_name)
,   m_pGameData(NULL)
{
    Engine::Core::I_BaseGameObject* pObject = &_group.createObject(_name);

    m_pBase = dynamic_cast<Engine::Base::I_BaseGameObject*>(pObject);
}

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
BaseObject::~BaseObject()
{
}

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
Engine::Core::I_GameObjectData*
BaseObject::getData()
{
    return m_pGameData;
}

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
void
BaseObject::setData(Engine::Core::I_GameObjectData* _pData)
{
    m_pGameData = _pData;
}

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
void
BaseObject::setScale(Engine::Core::I_BaseGameObject& _object, float _x, float _y, float _z)
{
    _object.setScale(_x, _y, _z);

    _object.getPhysicsShape()->setScale(_x * 100.0f, _y * 100.0f, _z * 100.0f);
}

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
void
BaseObject::loadRenderable(const std::string& _meshName, const std::string& _materialName)
{
    Zen::Engine::Resource::I_ResourceManager::config_type config;
    config["fileName"] = _meshName;
    config["label"] = m_name;
    config["type"] = "entity";

    
    m_pRenderable =
        Zen::Engine::Base::I_BaseGameClient::getSingleton().getRenderingResourceService().loadResource(config).as<pRenderableResource_type>();
    
    if (!_materialName.empty())
    {
        m_pRenderable->setMaterialName(_materialName);
    }

    baseBase().getSceneNode()->attachObject(*m_pRenderable.get());

}

//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
}   // namespace Pong
}   // namespace Zen
//-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~
